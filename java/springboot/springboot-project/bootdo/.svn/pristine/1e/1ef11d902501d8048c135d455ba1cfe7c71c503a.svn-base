<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.bootdo.system.dao.GrossSalesViewDao">

	<select id="get" resultType="com.bootdo.system.domain.GrossSalesViewDO">
		select `id`,`zz`,`gsbm`,`ysdh`,`ysdhh`,`ysrq`,`khbm`,`khmc`,`wlbm`,`ckbm`,`ckmc`,`xsckdh`,`xsckdhh`,`ckrq`,`cksl`,`ckdw`,`ckjbsl`,`ckjbdw`,`bb`,`sl`,`pzh`,`dwsjcb`,`sjcb`,`ysje`,`ysjebwb`,`fpsl`,`fpjldw`,`fpjbsl`,`fpjbjldw`,`fpcb`,`wkpsl`,`wkpcb`,`mll`,`flag`,`createdate` from sys_gross_sales_view where id = #{value}
	</select>

	<select id="list" resultType="com.bootdo.system.domain.GrossSalesViewDO">
		select `id`,`zz`,`gsbm`,`ysdh`,`ysdhh`,`ysrq`,`khbm`,`khmc`,`wlbm`,`ckbm`,`ckmc`,`xsckdh`,`xsckdhh`,`ckrq`,`cksl`,`ckdw`,`ckjbsl`,`ckjbdw`,`bb`,`sl`,`pzh`,`dwsjcb`,`sjcb`,`ysje`,`ysjebwb`,`fpsl`,`fpjldw`,`fpjbsl`,`fpjbjldw`,`fpcb`,`wkpsl`,`wkpcb`,`mll`,`flag`,`createdate` from sys_gross_sales_view
        <where>  
		  		  <if test="id != null and id != ''"> and id = #{id} </if>
		  		  <if test="zz != null and zz != ''"> and zz = #{zz} </if>
		  		  <if test="gsbm != null and gsbm != ''"> and gsbm = #{gsbm} </if>
		  		  <if test="ysdh != null and ysdh != ''"> and ysdh = #{ysdh} </if>
		  		  <if test="ysdhh != null and ysdhh != ''"> and ysdhh = #{ysdhh} </if>
		  		  <if test="ysrq != null and ysrq != ''"> and ysrq = #{ysrq} </if>
		  		  <if test="khbm != null and khbm != ''"> and khbm = #{khbm} </if>
		  		  <if test="khmc != null and khmc != ''"> and khmc = #{khmc} </if>
		  		  <if test="wlbm != null and wlbm != ''"> and wlbm = #{wlbm} </if>
		  		  <if test="ckbm != null and ckbm != ''"> and ckbm = #{ckbm} </if>
		  		  <if test="ckmc != null and ckmc != ''"> and ckmc = #{ckmc} </if>
		  		  <if test="xsckdh != null and xsckdh != ''"> and xsckdh = #{xsckdh} </if>
		  		  <if test="xsckdhh != null and xsckdhh != ''"> and xsckdhh = #{xsckdhh} </if>
		  		  <if test="ckrq != null and ckrq != ''"> and ckrq = #{ckrq} </if>
		  		  <if test="cksl != null and cksl != ''"> and cksl = #{cksl} </if>
		  		  <if test="ckdw != null and ckdw != ''"> and ckdw = #{ckdw} </if>
		  		  <if test="ckjbsl != null and ckjbsl != ''"> and ckjbsl = #{ckjbsl} </if>
		  		  <if test="ckjbdw != null and ckjbdw != ''"> and ckjbdw = #{ckjbdw} </if>
		  		  <if test="bb != null and bb != ''"> and bb = #{bb} </if>
		  		  <if test="sl != null and sl != ''"> and sl = #{sl} </if>
		  		  <if test="pzh != null and pzh != ''"> and pzh = #{pzh} </if>
		  		  <if test="dwsjcb != null and dwsjcb != ''"> and dwsjcb = #{dwsjcb} </if>
		  		  <if test="sjcb != null and sjcb != ''"> and sjcb = #{sjcb} </if>
		  		  <if test="ysje != null and ysje != ''"> and ysje = #{ysje} </if>
		  		  <if test="ysjebwb != null and ysjebwb != ''"> and ysjebwb = #{ysjebwb} </if>
		  		  <if test="fpsl != null and fpsl != ''"> and fpsl = #{fpsl} </if>
		  		  <if test="fpjldw != null and fpjldw != ''"> and fpjldw = #{fpjldw} </if>
		  		  <if test="fpjbsl != null and fpjbsl != ''"> and fpjbsl = #{fpjbsl} </if>
		  		  <if test="fpjbjldw != null and fpjbjldw != ''"> and fpjbjldw = #{fpjbjldw} </if>
		  		  <if test="fpcb != null and fpcb != ''"> and fpcb = #{fpcb} </if>
		  		  <if test="wkpsl != null and wkpsl != ''"> and wkpsl = #{wkpsl} </if>
		  		  <if test="wkpcb != null and wkpcb != ''"> and wkpcb = #{wkpcb} </if>
		  		  <if test="mll != null and mll != ''"> and mll = #{mll} </if>
		  		  <if test="flag != null and flag != ''"> and flag = #{flag} </if>
		  		  <if test="starttime != null and starttime != ''">and createdate <![CDATA[>=]]> #{starttime}</if>
 				  <if test="endtime != null and endtime != ''">and createdate <![CDATA[<=]]> #{endtime}</if>
		  		</where>
        <choose>
            <when test="sort != null and sort.trim() != ''">
                order by ${sort} ${order}
            </when>
			<otherwise>
                order by id desc
			</otherwise>
        </choose>
		<if test="offset != null and limit != null">
			limit #{offset}, #{limit}
		</if>
	</select>
	
 	<select id="count" resultType="int">
		select count(*) from sys_gross_sales_view
		 <where>  
		  		  <if test="id != null and id != ''"> and id = #{id} </if>
		  		  <if test="zz != null and zz != ''"> and zz = #{zz} </if>
		  		  <if test="gsbm != null and gsbm != ''"> and gsbm = #{gsbm} </if>
		  		  <if test="ysdh != null and ysdh != ''"> and ysdh = #{ysdh} </if>
		  		  <if test="ysdhh != null and ysdhh != ''"> and ysdhh = #{ysdhh} </if>
		  		  <if test="ysrq != null and ysrq != ''"> and ysrq = #{ysrq} </if>
		  		  <if test="khbm != null and khbm != ''"> and khbm = #{khbm} </if>
		  		  <if test="khmc != null and khmc != ''"> and khmc = #{khmc} </if>
		  		  <if test="wlbm != null and wlbm != ''"> and wlbm = #{wlbm} </if>
		  		  <if test="ckbm != null and ckbm != ''"> and ckbm = #{ckbm} </if>
		  		  <if test="ckmc != null and ckmc != ''"> and ckmc = #{ckmc} </if>
		  		  <if test="xsckdh != null and xsckdh != ''"> and xsckdh = #{xsckdh} </if>
		  		  <if test="xsckdhh != null and xsckdhh != ''"> and xsckdhh = #{xsckdhh} </if>
		  		  <if test="ckrq != null and ckrq != ''"> and ckrq = #{ckrq} </if>
		  		  <if test="cksl != null and cksl != ''"> and cksl = #{cksl} </if>
		  		  <if test="ckdw != null and ckdw != ''"> and ckdw = #{ckdw} </if>
		  		  <if test="ckjbsl != null and ckjbsl != ''"> and ckjbsl = #{ckjbsl} </if>
		  		  <if test="ckjbdw != null and ckjbdw != ''"> and ckjbdw = #{ckjbdw} </if>
		  		  <if test="bb != null and bb != ''"> and bb = #{bb} </if>
		  		  <if test="sl != null and sl != ''"> and sl = #{sl} </if>
		  		  <if test="pzh != null and pzh != ''"> and pzh = #{pzh} </if>
		  		  <if test="dwsjcb != null and dwsjcb != ''"> and dwsjcb = #{dwsjcb} </if>
		  		  <if test="sjcb != null and sjcb != ''"> and sjcb = #{sjcb} </if>
		  		  <if test="ysje != null and ysje != ''"> and ysje = #{ysje} </if>
		  		  <if test="ysjebwb != null and ysjebwb != ''"> and ysjebwb = #{ysjebwb} </if>
		  		  <if test="fpsl != null and fpsl != ''"> and fpsl = #{fpsl} </if>
		  		  <if test="fpjldw != null and fpjldw != ''"> and fpjldw = #{fpjldw} </if>
		  		  <if test="fpjbsl != null and fpjbsl != ''"> and fpjbsl = #{fpjbsl} </if>
		  		  <if test="fpjbjldw != null and fpjbjldw != ''"> and fpjbjldw = #{fpjbjldw} </if>
		  		  <if test="fpcb != null and fpcb != ''"> and fpcb = #{fpcb} </if>
		  		  <if test="wkpsl != null and wkpsl != ''"> and wkpsl = #{wkpsl} </if>
		  		  <if test="wkpcb != null and wkpcb != ''"> and wkpcb = #{wkpcb} </if>
		  		  <if test="mll != null and mll != ''"> and mll = #{mll} </if>
		  		  <if test="flag != null and flag != ''"> and flag = #{flag} </if>
		  		  <if test="starttime != null and starttime != ''">and createdate <![CDATA[>=]]> #{starttime}</if>
 				  <if test="endtime != null and endtime != ''">and createdate <![CDATA[<=]]> #{endtime}</if>
		  		</where>
	</select>
	 
	<insert id="save" parameterType="com.bootdo.system.domain.GrossSalesViewDO">
		insert into sys_gross_sales_view
		(
			`id`, 
			`zz`, 
			`gsbm`, 
			`ysdh`, 
			`ysdhh`, 
			`ysrq`, 
			`khbm`, 
			`khmc`, 
			`wlbm`, 
			`ckbm`, 
			`ckmc`, 
			`xsckdh`, 
			`xsckdhh`, 
			`ckrq`, 
			`cksl`, 
			`ckdw`, 
			`ckjbsl`, 
			`ckjbdw`, 
			`bb`, 
			`sl`, 
			`pzh`, 
			`dwsjcb`, 
			`sjcb`, 
			`ysje`, 
			`ysjebwb`, 
			`fpsl`, 
			`fpjldw`, 
			`fpjbsl`, 
			`fpjbjldw`, 
			`fpcb`, 
			`wkpsl`, 
			`wkpcb`, 
			`mll`,
			`flag`,
			`createdate`
		)
		values
		(
			#{id}, 
			#{zz}, 
			#{gsbm}, 
			#{ysdh}, 
			#{ysdhh}, 
			#{ysrq}, 
			#{khbm}, 
			#{khmc}, 
			#{wlbm}, 
			#{ckbm}, 
			#{ckmc}, 
			#{xsckdh}, 
			#{xsckdhh}, 
			#{ckrq}, 
			#{cksl}, 
			#{ckdw}, 
			#{ckjbsl}, 
			#{ckjbdw}, 
			#{bb}, 
			#{sl}, 
			#{pzh}, 
			#{dwsjcb}, 
			#{sjcb}, 
			#{ysje}, 
			#{ysjebwb}, 
			#{fpsl}, 
			#{fpjldw}, 
			#{fpjbsl}, 
			#{fpjbjldw}, 
			#{fpcb}, 
			#{wkpsl}, 
			#{wkpcb}, 
			#{mll},
			#{flag},
			#{createdate}
		)
	</insert>
	 
	<update id="update" parameterType="com.bootdo.system.domain.GrossSalesViewDO">
		update sys_gross_sales_view 
		<set>
			<if test="zz != null">`zz` = #{zz}, </if>
			<if test="gsbm != null">`gsbm` = #{gsbm}, </if>
			<if test="ysdh != null">`ysdh` = #{ysdh}, </if>
			<if test="ysdhh != null">`ysdhh` = #{ysdhh}, </if>
			<if test="ysrq != null">`ysrq` = #{ysrq}, </if>
			<if test="khbm != null">`khbm` = #{khbm}, </if>
			<if test="khmc != null">`khmc` = #{khmc}, </if>
			<if test="wlbm != null">`wlbm` = #{wlbm}, </if>
			<if test="ckbm != null">`ckbm` = #{ckbm}, </if>
			<if test="ckmc != null">`ckmc` = #{ckmc}, </if>
			<if test="xsckdh != null">`xsckdh` = #{xsckdh}, </if>
			<if test="xsckdhh != null">`xsckdhh` = #{xsckdhh}, </if>
			<if test="ckrq != null">`ckrq` = #{ckrq}, </if>
			<if test="cksl != null">`cksl` = #{cksl}, </if>
			<if test="ckdw != null">`ckdw` = #{ckdw}, </if>
			<if test="ckjbsl != null">`ckjbsl` = #{ckjbsl}, </if>
			<if test="ckjbdw != null">`ckjbdw` = #{ckjbdw}, </if>
			<if test="bb != null">`bb` = #{bb}, </if>
			<if test="sl != null">`sl` = #{sl}, </if>
			<if test="pzh != null">`pzh` = #{pzh}, </if>
			<if test="dwsjcb != null">`dwsjcb` = #{dwsjcb}, </if>
			<if test="sjcb != null">`sjcb` = #{sjcb}, </if>
			<if test="ysje != null">`ysje` = #{ysje}, </if>
			<if test="ysjebwb != null">`ysjebwb` = #{ysjebwb}, </if>
			<if test="fpsl != null">`fpsl` = #{fpsl}, </if>
			<if test="fpjldw != null">`fpjldw` = #{fpjldw}, </if>
			<if test="fpjbsl != null">`fpjbsl` = #{fpjbsl}, </if>
			<if test="fpjbjldw != null">`fpjbjldw` = #{fpjbjldw}, </if>
			<if test="fpcb != null">`fpcb` = #{fpcb}, </if>
			<if test="wkpsl != null">`wkpsl` = #{wkpsl}, </if>
			<if test="wkpcb != null">`wkpcb` = #{wkpcb}, </if>
			<if test="mll != null">`mll` = #{mll},</if>
			<if test="flag != null">`flag` = #{flag},</if>
			<if test="createdate != null">and `createdate` = #{createdate}</if>
			
		</set>
		where id = #{id}
	</update>
	
	<delete id="remove">
		delete from sys_gross_sales_view where id = #{value}
	</delete>
	
	<delete id="batchRemove">
		delete from sys_gross_sales_view where id in 
		<foreach item="id" collection="array" open="(" separator="," close=")">
			#{id}
		</foreach>
	</delete>
	
<!-- 	<delete id="batchUpdate"> -->
<!-- 		update from sys_gross_sales_view where id in  -->
<!-- 		<foreach item="id" collection="array" open="(" separator="," close=")"> -->
<!-- 			#{id} -->
<!-- 		</foreach> -->
<!-- 	</delete> -->
	

		<!-- 批量插入销售毛利数据 -->
     <insert id ="batchSave" parameterType="java.util.List" >
            <selectKey resultType ="java.lang.Integer" keyProperty= "id"
                 order= "AFTER">
                SELECT LAST_INSERT_ID()
            </selectKey >
           insert into sys_gross_sales_view
           (`zz`,`gsbm`,`ysdh`,`ysdhh`,`ysrq`,`khbm`,`khmc`,`wlbm`,`ckbm`,`ckmc`,`xsckdh`,`xsckdhh`,`ckrq`,`cksl`,`ckdw`,`ckjbsl`,`ckjbdw`,`bb`,`pzh`,`sl`,`dwsjcb`,`sjcb`,`ysje`,`ysjebwb`,`fpsl`,`fpjldw`,`fpjbsl`,`fpjbjldw`,`fpcb`,`wkpsl`,`wkpcb`,`mll`,`flag`,`createdate`)
           values
            <foreach collection ="list" item="reddemCode" index= "index" separator =",">
                (
                	#{reddemCode.zz}, 
					#{reddemCode.gsbm}, 
					#{reddemCode.ysdh}, 
					#{reddemCode.ysdhh}, 
					#{reddemCode.ysrq}, 
					#{reddemCode.khbm}, 
					#{reddemCode.khmc}, 
					#{reddemCode.wlbm}, 
					#{reddemCode.ckbm}, 
					#{reddemCode.ckmc}, 
					#{reddemCode.xsckdh}, 
					#{reddemCode.xsckdhh}, 
					#{reddemCode.ckrq}, 
					#{reddemCode.cksl}, 
					#{reddemCode.ckdw}, 
					#{reddemCode.ckjbsl}, 
					#{reddemCode.ckjbdw}, 
					#{reddemCode.bb}, 
					#{reddemCode.pzh}, 
					#{reddemCode.sl}, 
					#{reddemCode.dwsjcb}, 
					#{reddemCode.sjcb}, 
					#{reddemCode.ysje}, 
					#{reddemCode.ysjebwb}, 
					#{reddemCode.fpsl}, 
					#{reddemCode.fpjldw}, 
					#{reddemCode.fpjbsl}, 
					#{reddemCode.fpjbjldw}, 
					#{reddemCode.fpcb}, 
					#{reddemCode.wkpsl}, 
					#{reddemCode.wkpcb}, 
					#{reddemCode.mll},
					0,
					now()
                )
            </foreach >
     </insert >
     
     <update id="batchUpdate" parameterType="java.util.List">
	    update sys_gross_sales_view 
	    set  flag =
	    <foreach collection="list" item="item" index="index" 
	        separator=" " open="case ID" close="end">
	        when #{item.id} then 1
	    </foreach>
	    where id in
	    <foreach collection="list" index="index" item="item" 
	        separator="," open="(" close=")">
	        #{item.id,jdbcType=BIGINT}
	    </foreach>
	 </update>
</mapper>